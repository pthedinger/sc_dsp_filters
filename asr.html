
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>module_asr &mdash; Documentation  documentation</title>
    <link rel="stylesheet" href="_static/xdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/xcomment.js"></script>
    <link rel="top" title="Documentation  documentation" href="index.html" />
    <link rel="prev" title="Using FIR filters" href="fir.html" /> 

<script>
function setheight() {
h1 = document.getElementById('d1').style.height;
h2 = document.getElementById('d2').style.height;

if (parseInt(h1) > parseInt(h2)) {
document.getElementById('d2').style.height=h1 + "px";
}
else {
document.getElementById('d1').style.height=h2 + "px";
}

}
</script>
</head>

<body onload="setheight();">

  

    <div class="document" id='d1'>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
<div style="float: right">
<a href="fir.html"
                        title="previous chapter"> &lt&lt </a>
</div>

            
  <div class="section" id="module-asr">
<h1>module_asr<a class="headerlink" href="#module-asr" title="Permalink to this headline">¶</a></h1>
<p>The Asynchronous Sample Rate converter is capable of deleting sample values
in random places in the input stream. This operation introduces harmoic
distortion, but can be used when two asynchronous clocks provide data and
you want to keep them in sync.</p>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="types">
<h3>Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="asrState">
<tt class="descname">asrState</tt><a class="headerlink" href="#asrState" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure that is used to store the state of the converter.</p>
<p>One structure should be declared for each channel that the converter is executed on. The internals of this structure are relevant only inside the converter and should not be relied upon by the caller.</p>
<p><strong>Structure Members:</strong></p>
<dl class="member">
<dt id="asrState.wr">
int <tt class="descname">wr</tt><a class="headerlink" href="#asrState.wr" title="Permalink to this definition">¶</a></dt>
<dd><p>Current index in historic sample value, points one above the last value written.</p>
</dd></dl>

<dl class="member">
<dt id="asrState.insertIndex">
int <tt class="descname">insertIndex</tt><a class="headerlink" href="#asrState.insertIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>whether we are currently interpolating, and if so where</p>
</dd></dl>

<dl class="member">
<dt id="asrState.buffer">
int <tt class="descname">buffer</tt><a class="headerlink" href="#asrState.buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>historic sample values</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="asrInit">
void <tt class="descname">asrInit</tt><big>(</big>struct <a class="reference internal" href="#asrState" title="asrState"><span>asrState</span></a><em>&nbsp;&amp;state</em><big>)</big><a class="headerlink" href="#asrInit" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that initialises the asynchronous sample rate converter.</p>
<p>This resets the state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>state</strong> &#8211; buffer structure containing past sample values for interpolation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="asrDelete">
int <tt class="descname">asrDelete</tt><big>(</big>int<em>&nbsp;sample</em>, int<em>&nbsp;delete</em>, struct <a class="reference internal" href="#asrState" title="asrState"><span>asrState</span></a><em>&nbsp;&amp;state</em><big>)</big><a class="headerlink" href="#asrDelete" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that produces a new sample, possibly interpolating.</p>
<p>To be called on every sample, set the parameter <tt class="docutils literal"><span class="pre">delete</span></tt> to 1 to indicate that this sample is to be deleted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample</strong> &#8211; current sample value</li>
<li><strong>delete</strong> &#8211; boolean to indicate that a sample shall be deleted from the stream. When delete is true, the return value of this function should be ignored.</li>
<li><strong>state</strong> &#8211; buffer structure containing past sample values for interpolation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">an interpolated sample value, or 0 if delete is true.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>A simple example on how to use it is shown below. <strong>to be provided</strong></p>
<p>A more complex example has two input streams, and it will delete a sample
on either stream when it runs ahead too far.</p>
<div class="highlight-none"><div class="highlight"><pre>// This example is untested... Ought to be...
void twoStreamExample(chanend inX, chanend inY, chanend outX, chanend outY) {
    struct asrState asrStateX, asrStateY;
    int sample;
    asrInit(asrStateX);
    asrInit(asrStateY);
    while(1) {
        select {
        case inX :&gt; sample:
            diff++;
            if (diff &gt; 10) {
                deleteOne = 1;
                diff--;
            }
            v = asrDelete(sample, deleteOne, asrStateX);
            if (!deleteOne) {
                outX &lt;: v;
            }
            break;
        case inY :&gt; sample:
            diff--;
            if (diff &lt; -10) {
                deleteOne = 1;
                diff++;
            }
            v = asrDelete(sample, deleteOne, asrStateY);
            if (!deleteOne) {
                outY &lt;: v;
            }
            break;
        }
    }
}
</pre></div>
</div>
</div>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" id='d2'>
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Documentation</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary.html">DSP Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="biquad.html">module_cascading_biquad</a></li>
<li class="toctree-l1"><a class="reference internal" href="fir.html">Using FIR filters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">module_asr</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#types">Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none;margin-bottom: 10px;">
  <h3>Search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>



    <div class="footer">
    </div>
  </body>
</html>



